<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Periodontitis Evre ve Derece Hesaplama</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2a5298;
            --secondary-color: #1e3c72;
        }

        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-family: 'Segoe UI', system-ui, sans-serif;
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .language-switcher {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
            cursor: pointer;
            background: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .gradient-text {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.8rem;
        }

        @media (max-width: 768px) {
            .gradient-text {
                font-size: 1.5rem;
            }
            
            .glass-card {
                padding: 1rem;
                margin: 0.5rem 0;
            }
            
            .form-control, .form-select {
                font-size: 0.9rem;
                padding: 0.5rem 0.75rem;
            }
            
            .btn-lg {
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
            }
            
            .alert h4 {
                font-size: 1.2rem;
            }
        }

        .mobile-optimized-input {
            margin-bottom: 12px;
        }

        .list-group-item {
            font-size: 0.95rem;
            padding: 0.75rem 1.25rem;
        }
    </style>
</head>
<body>
    <div class="language-switcher" onclick="toggleLanguage()">
        <span id="languageFlag">EN</span>
    </div>

    <div class="container py-3">
        <div class="text-center mb-3">
            <h1 class="gradient-text fw-bold mb-1" data-translate="title">🦷 Periodontitis Evre ve Derece Hesaplama</h1>
            <p class="text-muted mb-1" data-translate="subtitle">📚 2017 AAP/EFP Kriterleri</p>
            <p class="text-muted small" data-translate="author">👨⚕️ Dt. Bilal Emre Aksoy</p>
        </div>

        <div class="glass-card">
            <form id="assessmentForm">
                <div class="row g-3">
                    <div class="col-12 mobile-optimized-input">
                        <label class="form-label" data-translate="probingDepth">📏 Maks. Cep Derinliği (mm)</label>
                        <input type="number" class="form-control" id="probingDepth" min="1" max="12" required>
                    </div>
                    
                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="cal">📉 Ataşman Kaybı (mm)</label>
                        <input type="number" class="form-control" id="cal" min="0" max="10" required>
                    </div>
                    
                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="boneLoss">🦴 Kemik Kaybı (%)</label>
                        <div class="input-group">
                            <input type="number" class="form-control" id="boneLoss" min="0" max="100" required>
                            <span class="input-group-text">%</span>
                        </div>
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="furcation">⚠️ Furkasyon</label>
                        <select class="form-select" id="furcation" required>
                            <option value="0">Yok</option>
                            <option value="1">Sınıf I</option>
                            <option value="2">Sınıf II</option>
                            <option value="3">Sınıf III</option>
                        </select>
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="mobility">🔄 Mobilite</label>
                        <select class="form-select" id="mobility" required>
                            <option value="0">Yok</option>
                            <option value="1">Derece I</option>
                            <option value="2">Derece II</option>
                            <option value="3">Derece III</option>
                        </select>
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="smoking">🚬 Sigara</label>
                        <select class="form-select" id="smoking">
                            <option value="0">Yok</option>
                            <option value="1"><10/gün</option>
                            <option value="2">≥10/gün</option>
                        </select>
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="hba1c">🩸 HbA1c</label>
                        <input type="number" class="form-control" id="hba1c" step="0.1" min="4" max="15">
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="age">🎂 Yaş</label>
                        <input type="number" class="form-control" id="age" min="18" max="120" required>
                    </div>

                    <div class="col-12 col-md-6 mobile-optimized-input">
                        <label class="form-label" data-translate="toothLoss">❌ Kayıp Diş</label>
                        <input type="number" class="form-control" id="toothLoss" min="0" max="32">
                    </div>
                </div>

                <button type="button" class="btn btn-primary btn-lg w-100 mt-3" onclick="runAnalysis()" data-translate="analyze">
                    🔍 Analiz Başlat
                </button>
            </form>
        </div>

        <div id="results" class="glass-card" style="display:none;">
            <div class="row">
                <div class="col-12 mb-3">
                    <div class="alert alert-danger">
                        <h4 id="stageResult" data-translate="stage">🎯 Evre</h4>
                        <ul id="stageCriteria" class="list-group"></ul>
                    </div>
                </div>
                <div class="col-12 mb-3">
                    <div class="alert alert-warning">
                        <h4 id="gradeResult" data-translate="grade">📊 Derece</h4>
                        <ul id="gradeCriteria" class="list-group"></ul>
                    </div>
                </div>
            </div>

            <div class="treatment-plan mt-3">
                <h3 class="text-success mb-3" data-translate="treatmentPlan">💊 Tedavi Protokolü</h3>
                <div id="treatmentSteps"></div>
            </div>
        </div>
    </div>
        <div id="results" class="glass-card" style="display:none;">
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="alert alert-danger">
                        <h4 id="stageResult" data-translate="stage">🎯 Evre</h4>
                        <ul id="stageCriteria" class="list-group"></ul>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="alert alert-warning">
                        <h4 id="gradeResult" data-translate="grade">📊 Derece</h4>
                        <ul id="gradeCriteria" class="list-group"></ul>
                    </div>
                </div>
            </div>

            <div class="treatment-plan mt-4">
                <h3 class="text-success mb-4" data-translate="treatmentPlan">💊 Tedavi Protokolü</h3>
                <div id="treatmentSteps"></div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p class="mb-0">© 2024 Dt. Bilal Emre Aksoy - Tüm hakları saklıdır</p>
        </div>
    </footer>

    <script>
        const translations = {
            en: {
                title: "🦷 Periodontitis Stage & Grade Calculator",
                subtitle: "📚 2017 AAP/EFP Criteria - Professional Module",
                author: "👨⚕️ Dr. Bilal Emre Aksoy",
                probingDepth: "📏 Max. Probing Depth (mm)",
                cal: "📉 Clinical Attachment Loss (mm)",
                boneLoss: "🦴 Radiographic Bone Loss (%)",
                furcation: "⚠️ Furcation Defect",
                mobility: "🔄 Tooth Mobility",
                smoking: "🚬 Smoking (daily)",
                hba1c: "🩸 HbA1c (%)",
                age: "🎂 Patient Age",
                toothLoss: "❌ Missing Teeth Count",
                analyze: "🔍 Start Analysis",
                stage: "🎯 Stage",
                grade: "📊 Grade",
                treatmentPlan: "💊 Treatment Protocol",
                criteria: {
                    furcation: ["None", "Class I", "Class II", "Class III"],
                    mobility: ["None", "Grade I", "Grade II", "Grade III"],
                    smoking: ["No", "<10/day", "≥10/day"]
                }
            },
            tr: {
                title: "🦷 Periodontitis Evre ve Derece Hesaplama",
                subtitle: "📚 2017 AAP/EFP Kriterleri - Profesyonel Modül",
                author: "👨⚕️ Dt. Bilal Emre Aksoy",
                probingDepth: "📏 Maks. Sondalanan Cep Derinliği (mm)",
                cal: "📉 Klinik Ataşman Kaybı (mm)",
                boneLoss: "🦴 Radyografik Kemik Kaybı (%)",
                furcation: "⚠️ Furkasyon Defekti",
                mobility: "🔄 Diş Mobilitesi",
                smoking: "🚬 Sigara (günlük)",
                hba1c: "🩸 HbA1c (%)",
                age: "🎂 Hasta Yaşı",
                toothLoss: "❌ Kayıp Diş Sayısı",
                analyze: "🔍 Analiz Başlat",
                stage: "🎯 Evre",
                grade: "📊 Derece",
                treatmentPlan: "💊 Tedavi Protokolü",
                criteria: {
                    furcation: ["Yok", "Sınıf I", "Sınıf II", "Sınıf III"],
                    mobility: ["Yok", "Derece I", "Derece II", "Derece III"],
                    smoking: ["Yok", "<10 adet", "≥10 adet"]
                }
            }
        };

        let currentLang = 'tr';

        function toggleLanguage() {
            currentLang = currentLang === 'tr' ? 'en' : 'tr';
            document.getElementById('languageFlag').textContent = currentLang === 'tr' ? 'EN' : 'TR';
            translatePage();
        }

        function translatePage() {
            // Genel metinler
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.dataset.translate;
                if(translations[currentLang][key]) {
                    el.innerHTML = translations[currentLang][key];
                }
            });

            // Select option'ları
            translateSelect('furcation', 'furcation');
            translateSelect('mobility', 'mobility');
            translateSelect('smoking', 'smoking');
        }

        function translateSelect(selectId, key) {
            const select = document.getElementById(selectId);
            Array.from(select.options).forEach((option, index) => {
                option.text = translations[currentLang].criteria[key][index];
            });
        }

        function determineStage(inputs) {
            const { cal, boneLoss, toothLoss, furcation, mobility } = inputs;
            
            if(toothLoss >= 5 || (cal >= 6 && boneLoss > 50) || (mobility >= 2 && boneLoss > 60)) {
                return {
                    stage: "IV",
                    criteria: ["⛔ ≥5 diş kaybı", "💀 İleri kemik yıkımı", "🔄 Patolojik mobilite"]
                };
            }
            
            if((cal >= 5 || boneLoss >= 33) && (furcation >= 2 || mobility >= 1)) {
                return {
                    stage: "III",
                    criteria: ["⚠️ Furkasyon defekti", "🕳️ Derin cep varlığı", "📉 Kemik kaybı >%33"]
                };
            }
            
            if(cal >= 3 || boneLoss >= 15) {
                return {
                    stage: "II",
                    criteria: ["📌 Orta kemik kaybı", "↔️ Horizontal yıkım", "📏 CAL 3-4mm"]
                };
            }
            
            return {
                stage: "I",
                criteria: ["🌱 Sınırlı inflamasyon", "🔍 Yüzeysel lezyonlar", "🦴 <%15 kemik kaybı"]
            };
        }

        function determineGrade(inputs) {
            const { boneLoss, age, smoking, hba1c } = inputs;
            const annualLoss = (boneLoss / age).toFixed(2);
            let grade = "A";
            let criteria = [];

            if(annualLoss > 1.0 || smoking === 2 || hba1c >= 7) {
                grade = "C";
                criteria.push(`🚀 Yıllık progresyon: ${annualLoss}%`);
                if(smoking === 2) criteria.push("🚬 Günde ≥10 sigara");
                if(hba1c >=7) criteria.push(`🩸 HbA1c: ${hba1c}%`);
            } else if((annualLoss >= 0.5 && annualLoss <= 1.0) || smoking === 1 || (hba1c >=5.7 && hba1c <7)) {
                grade = "B";
                criteria.push(`📈 Yıllık progresyon: ${annualLoss}%`);
                if(smoking ===1) criteria.push("🚬 Günde <10 sigara");
                if(hba1c >=5.7) criteria.push(`🩸 HbA1c: ${hba1c}%`);
            } else {
                criteria.push(`🐢 Yıllık progresyon: ${annualLoss}%`, "✅ Risk faktörü yok");
            }

            return { grade, criteria };
        }

        function generateTreatmentPlan(stage) {
            const plans = {
                I: [
                    "🧼 Profesyonel mekanik temizlik",
                    "🎓 Hasta eğitimi ve motivasyon",
                    "🕒 3 aylık kontroller"
                ],
                II: [
                    "🔧 Kök yüzeyi düzleştirme",
                    "💊 Lokal antibiyoterapi",
                    "📅 6 haftalık takip"
                ],
                III: [
                    "⚡ Lazer asistli tedavi",
                    "💉 Sistemik antibiyotik",
                    "⚠️ Cerrahi (son seçenek)"
                ],
                IV: [
                    "👥 Multidisipliner yaklaşım",
                    "🦷 İmplant planlaması",
                    "🏥 Haftalık destek"
                ]
            };

            let html = `<div class="list-group">`;
            html += plans[stage].map(step => `
                <div class="list-group-item border-0">
                    <i class="bi bi-check2-circle text-success me-2"></i>
                    ${step}
                </div>
            `).join('');
            
            if(stage === "III" || stage === "IV") {
                html += `
                    <div class="alert alert-warning mt-3">
                        <h5>⚠️ Cerrahi Endikasyonları:</h5>
                        <ul class="mb-0">
                            <li>🔍 6mm+ rezidüel cepler</li>
                            <li>🦴 Kemik içi defekt</li>
                            <li>⚠️ İleri furkasyon problemi</li>
                        </ul>
                    </div>
                `;
            }
            
            return html;
        }

        function runAnalysis() {
            const inputs = {
                probingDepth: parseInt(document.getElementById('probingDepth').value),
                cal: parseInt(document.getElementById('cal').value),
                boneLoss: parseInt(document.getElementById('boneLoss').value),
                furcation: parseInt(document.getElementById('furcation').value),
                mobility: parseInt(document.getElementById('mobility').value),
                smoking: parseInt(document.getElementById('smoking').value),
                hba1c: parseFloat(document.getElementById('hba1c').value) || 0,
                age: parseInt(document.getElementById('age').value),
                toothLoss: parseInt(document.getElementById('toothLoss').value) || 0
            };

            const stage = determineStage(inputs);
            const grade = determineGrade(inputs);

            document.getElementById('stageResult').innerHTML = `${translations[currentLang].stage} ${stage.stage}`;
            document.getElementById('stageCriteria').innerHTML = stage.criteria.map(c => `
                <li class="list-group-item">${c}</li>
            `).join('');

            document.getElementById('gradeResult').innerHTML = `${translations[currentLang].grade} ${grade.grade}`;
            document.getElementById('gradeCriteria').innerHTML = grade.criteria.map(c => `
                <li class="list-group-item">${c}</li>
            `).join('');

            document.getElementById('treatmentSteps').innerHTML = generateTreatmentPlan(stage.stage);
            document.getElementById('results').style.display = 'block';
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
</body>
</html>
